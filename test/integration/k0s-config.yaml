apiVersion: k0s.k0sproject.io/v1beta1
kind: ClusterConfig
metadata:
  name: k0s-integration-test
spec:
  api:
    address: 0.0.0.0
    port: 6443
    sans:
      - k0s
      - localhost
      - 127.0.0.1
  
  controllerManager:
    extraArgs:
      bind-address: 0.0.0.0
  
  scheduler:
    extraArgs:
      bind-address: 0.0.0.0
  
  network:
    provider: calico
    calico:
      mode: vxlan
      overlay: Always
      mtu: 1450
  
  podCIDR: 10.244.0.0/16
  serviceCIDR: 10.96.0.0/12
  
  storage:
    type: etcd
  
  konnectivity:
    adminPort: 8133
    agentPort: 8132
  
  extensions:
    helm:
      repositories:
        - name: flux
          url: https://fluxcd-community.github.io/helm-charts
      charts:
        - name: flux2
          chartname: flux/flux2
          version: "2.12.1"
          namespace: flux-system
          values: |
            controllers:
              source:
                create: true
              kustomize:
                create: true
              helm:
                create: true
              notification:
                create: false
              image-reflector:
                create: false
              image-automation:
                create: false